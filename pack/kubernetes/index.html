



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for Atomist - How Teams Deliver Software">
      
      
      
        <meta name="author" content="The Atomist Team">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
      
        <title>Kubernetes - Atomist Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/fix-mime-type-application.451f80e5.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/fix-mime-type-application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/fix-mime-type-material-icons.css">
    
      <link rel="stylesheet" href="../../stylesheets/fix-mime-type-extra.css">
    
    
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MZ8NMFS');</script>
    <!-- End Google Tag Manager -->
<link rel="stylesheet" href="https://use.typekit.net/viv5qyy.css">

  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../../#overview" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
<!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MZ8NMFS"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Atomist Documentation" class="md-header-nav__button md-logo">
          <img src="../../img/atomist-developer-docs-logo.png" alt="Atomist Developer Docs">
        </a>
      </div>

      <div class="md-flex__cell md-flex__cell--stretch visit-main-site">
        <a href="https://www.atomist.com" target="_blank">Visit Atomist.com &raquo;</a>
      </div>
    </div>
  </nav>
  <div class="title-and-search-bar">
    <div class="md-grid">
      <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--stretch">
          <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
            
            
            <span class="md-header-nav__topic">
              Atomist Documentation
            </span>
            <span class="md-header-nav__topic">
              Kubernetes
            </span>
            
            
          </div>
        </div>
        <div class="md-flex__cell md-flex__cell--shrink">
          
          
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
          
        </div>
      </div>
    </div>
  </div>
</header>

    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <!-- Main navigation -->
<nav class="md-nav md-nav--primary" data-md-level="0">

  <!-- Site title -->
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    Choose Section
  </label>

  <!-- Repository containing source -->
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/atomist/docs/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  

  <!-- Render item list -->
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Using Atomist
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Using Atomist
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../user/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user/dashboard/" title="Atomist web interface" class="md-nav__link">
      Atomist web interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user/github/" title="Source Control" class="md-nav__link">
      Source Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user/slack/" title="Slack" class="md-nav__link">
      Slack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user/lifecycle/" title="Built-in Chat Integrations" class="md-nav__link">
      Built-in Chat Integrations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user/integrations/" title="Supported Integrations" class="md-nav__link">
      Supported Integrations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../quick-start/" title="Developer Quick Start" class="md-nav__link">
      Developer Quick Start
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Developer Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Developer Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/" title="What you can do" class="md-nav__link">
      What you can do
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/architecture/" title="Architecture" class="md-nav__link">
      Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      Running an SDM
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        Running an SDM
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/sdm/" title="About the SDM" class="md-nav__link">
      About the SDM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/prerequisites/" title="Prerequisites" class="md-nav__link">
      Prerequisites
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/team/" title="Team Mode" class="md-nav__link">
      Team Mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/local/" title="Local Mode" class="md-nav__link">
      Local Mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/sdm-deploy/" title="Deploying your SDM" class="md-nav__link">
      Deploying your SDM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/sdm-debug/" title="Debugging an SDM" class="md-nav__link">
      Debugging an SDM
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      Goals
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        Goals
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/goal/" title="Create Goals" class="md-nav__link">
      Create Goals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/set-goals/" title="Setting Goals" class="md-nav__link">
      Setting Goals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/goals-more/" title="Doing More with Goals" class="md-nav__link">
      Doing More with Goals
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/event/" title="Event Listeners" class="md-nav__link">
      Event Listeners
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6" type="checkbox" id="nav-4-6">
    
    <label class="md-nav__link" for="nav-4-6">
      Builds
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-6">
        Builds
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/build/" title="Build Goal" class="md-nav__link">
      Build Goal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user/ci/" title="Integrations" class="md-nav__link">
      Integrations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/deploy/" title="Deploys" class="md-nav__link">
      Deploys
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/inspect/" title="Code Inspections" class="md-nav__link">
      Code Inspections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Code Transforms
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Code Transforms
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/transform/" title="Transforms" class="md-nav__link">
      Transforms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/autofix/" title="Autofixes" class="md-nav__link">
      Autofixes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/project/" title="Project" class="md-nav__link">
      Project
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/commands/" title="Commands" class="md-nav__link">
      Commands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/create/" title="Project Generators" class="md-nav__link">
      Project Generators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/fingerprint/" title="Fingerprints" class="md-nav__link">
      Fingerprints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-13" type="checkbox" id="nav-4-13">
    
    <label class="md-nav__link" for="nav-4-13">
      Advanced
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-13">
        Advanced
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/sdm-concepts/" title="SDM Concepts" class="md-nav__link">
      SDM Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/config/" title="SDM Configuration" class="md-nav__link">
      SDM Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/spawn/" title="Running External Commands" class="md-nav__link">
      Running External Commands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/logging/" title="Logging" class="md-nav__link">
      Logging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/push-test/" title="Push Tests" class="md-nav__link">
      Push Tests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/reporef/" title="RepoRef" class="md-nav__link">
      RepoRef
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/spawn-builder/" title="Generic Builder" class="md-nav__link">
      Generic Builder
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/http/" title="HTTP Calls in an SDM" class="md-nav__link">
      HTTP Calls in an SDM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/graphql/" title="Custom GraphQL Queries" class="md-nav__link">
      Custom GraphQL Queries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/pxe/" title="Path Expressions" class="md-nav__link">
      Path Expressions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/slack/" title="Chat Messages" class="md-nav__link">
      Chat Messages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/cli/" title="Command Line Interface" class="md-nav__link">
      Command Line Interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/security/" title="Security Model" class="md-nav__link">
      Security Model
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/typescript/" title="TypeScript Hints" class="md-nav__link">
      TypeScript Hints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developer/troubleshoot/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Extensions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Extensions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Extension Packs" class="md-nav__link">
      Extension Packs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../build/" title="Build" class="md-nav__link">
      Build
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/" title="Changelog" class="md-nav__link">
      Changelog
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../checkstyle/" title="Checkstyle" class="md-nav__link">
      Checkstyle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pcf/" title="Cloud Foundry" class="md-nav__link">
      Cloud Foundry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker/" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Kubernetes
      </label>
    
    <a href="./" title="Kubernetes" class="md-nav__link md-nav__link--active">
      Kubernetes
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" title="Overview" class="md-nav__link">
    Overview
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sdm-extension-pack" title="SDM Extension Pack" class="md-nav__link">
    SDM Extension Pack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploying-and-updating-applications" title="Deploying and updating applications" class="md-nav__link">
    Deploying and updating applications
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#container-status" title="Container status" class="md-nav__link">
    Container status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#role-based-access-control-rbac" title="Role-Based Access Control (RBAC)" class="md-nav__link">
    Role-Based Access Control (RBAC)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cluster-vs-namespace" title="Cluster vs. namespace" class="md-nav__link">
    Cluster vs. namespace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cluster-environment" title="Cluster environment" class="md-nav__link">
    Cluster environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#atomist-workspace" title="Atomist workspace" class="md-nav__link">
    Atomist workspace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes-cluster" title="Kubernetes cluster" class="md-nav__link">
    Kubernetes cluster
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" title="Installation" class="md-nav__link">
    Installation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#atomist-cli" title="Atomist CLI" class="md-nav__link">
    Atomist CLI
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cluster-wide-mode" title="Cluster-wide mode" class="md-nav__link">
    Cluster-wide mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#namespace-scoped-mode" title="Namespace-scoped mode" class="md-nav__link">
    Namespace-scoped mode
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes-cli" title="Kubernetes CLI" class="md-nav__link">
    Kubernetes CLI
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cluster-wide-mode_1" title="Cluster-wide mode" class="md-nav__link">
    Cluster-wide mode
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#k8vent" title="k8vent" class="md-nav__link">
    k8vent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k8-automation" title="k8-automation" class="md-nav__link">
    k8-automation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#namespace-scoped-mode_1" title="Namespace-scoped mode" class="md-nav__link">
    Namespace-scoped mode
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#k8vent_1" title="k8vent" class="md-nav__link">
    k8vent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k8-automation_1" title="k8-automation" class="md-nav__link">
    k8-automation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helm" title="Helm" class="md-nav__link">
    Helm
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cluster-wide-mode_2" title="Cluster-wide mode" class="md-nav__link">
    Cluster-wide mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#namespace-scoped-mode_2" title="Namespace-scoped mode" class="md-nav__link">
    Namespace-scoped mode
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating" title="Updating" class="md-nav__link">
    Updating
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../issue/" title="Issue" class="md-nav__link">
      Issue
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sloc/" title="Lines of Code" class="md-nav__link">
      Lines of Code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../node/" title="Node" class="md-nav__link">
      Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sonarqube/" title="Sonarqube" class="md-nav__link">
      Sonarqube
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spring/" title="Spring" class="md-nav__link">
      Spring
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      API Reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        API Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="https://atomist.github.io/automation-client/" title="automation-client" class="md-nav__link">
      automation-client
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://atomist.github.io/sdm/" title="sdm" class="md-nav__link">
      sdm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://atomist.github.io/sdm-pack-build/" title="sdm-pack-build" class="md-nav__link">
      sdm-pack-build
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://atomist.github.io/sdm-pack-checkstyle/" title="sdm-pack-checkstyle" class="md-nav__link">
      sdm-pack-checkstyle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://atomist.github.io/sdm-pack-cloudfoundry/" title="sdm-pack-cloudfoundry" class="md-nav__link">
      sdm-pack-cloudfoundry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://atomist.github.io/sdm-pack-k8s/" title="sdm-pack-k8s" class="md-nav__link">
      sdm-pack-k8s
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://atomist.github.io/sdm-pack-sloc/" title="sdm-pack-sloc" class="md-nav__link">
      sdm-pack-sloc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://atomist.github.io/sdm-pack-spring/" title="sdm-pack-spring" class="md-nav__link">
      sdm-pack-spring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://atomist.github.io/sdm-pack-sonarqube/" title="sdm-pack-sonarqube" class="md-nav__link">
      sdm-pack-sonarqube
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../support/" title="Support" class="md-nav__link">
      Support
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" title="Overview" class="md-nav__link">
    Overview
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sdm-extension-pack" title="SDM Extension Pack" class="md-nav__link">
    SDM Extension Pack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploying-and-updating-applications" title="Deploying and updating applications" class="md-nav__link">
    Deploying and updating applications
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#container-status" title="Container status" class="md-nav__link">
    Container status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#role-based-access-control-rbac" title="Role-Based Access Control (RBAC)" class="md-nav__link">
    Role-Based Access Control (RBAC)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cluster-vs-namespace" title="Cluster vs. namespace" class="md-nav__link">
    Cluster vs. namespace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cluster-environment" title="Cluster environment" class="md-nav__link">
    Cluster environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#atomist-workspace" title="Atomist workspace" class="md-nav__link">
    Atomist workspace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes-cluster" title="Kubernetes cluster" class="md-nav__link">
    Kubernetes cluster
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" title="Installation" class="md-nav__link">
    Installation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#atomist-cli" title="Atomist CLI" class="md-nav__link">
    Atomist CLI
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cluster-wide-mode" title="Cluster-wide mode" class="md-nav__link">
    Cluster-wide mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#namespace-scoped-mode" title="Namespace-scoped mode" class="md-nav__link">
    Namespace-scoped mode
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes-cli" title="Kubernetes CLI" class="md-nav__link">
    Kubernetes CLI
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cluster-wide-mode_1" title="Cluster-wide mode" class="md-nav__link">
    Cluster-wide mode
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#k8vent" title="k8vent" class="md-nav__link">
    k8vent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k8-automation" title="k8-automation" class="md-nav__link">
    k8-automation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#namespace-scoped-mode_1" title="Namespace-scoped mode" class="md-nav__link">
    Namespace-scoped mode
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#k8vent_1" title="k8vent" class="md-nav__link">
    k8vent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k8-automation_1" title="k8-automation" class="md-nav__link">
    k8-automation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helm" title="Helm" class="md-nav__link">
    Helm
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cluster-wide-mode_2" title="Cluster-wide mode" class="md-nav__link">
    Cluster-wide mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#namespace-scoped-mode_2" title="Namespace-scoped mode" class="md-nav__link">
    Namespace-scoped mode
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating" title="Updating" class="md-nav__link">
    Updating
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/atomist/docs/edit/master/docs/pack/kubernetes.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Kubernetes</h1>
                
                <p>Atomist provides the easiest and most flexible way to get from ideas
and customer requests to a solution deployed in
<a href="https://kubernetes.io/" title="Kubernetes">Kubernetes</a>.  Once deployed, Atomist provides feedback on
the health of running applications and uses standard Kubernetes
mechanism for zero-downtime deployments.</p>
<h2 id="overview">Overview</h2>
<p>Before getting started, it is helpful to provide some information
about how Atomist interacts with Kubernetes.  Atomist is able to
deploy and update applications to Kubernetes as well as report back on
the health of those applications, providing feedback in the Atomist
web interface or Slack on deployments running containers across clusters
and namespaces in the concise, correlated manner users of Atomist
expect.</p>
<p>This integration has three parts: the <a href="#sdm-extension-pack">SDM extension pack</a>,
a <a href="#deploying-and-updating-applications">process for executing deploys</a> and a
 <a href="#container-status">process for transmitting events</a>.</p>
<h3 id="sdm-extension-pack">SDM Extension Pack</h3>
<p>The extension pack (<a href="https://github.com/atomist/sdm-pack-k8s">github</a>, [API doc])
adds functions to your <a href="../../developer/sdm/">SDM</a> for deploying to Kubernetes.</p>
<p><a href="https://atomist.github.io/sdm-pack-k8s/">apidoc</a></p>
<h3 id="deploying-and-updating-applications">Deploying and updating applications</h3>
<p>The Atomist <a href="https://github.com/atomist/k8-automation" title="Atomist k8-automation">k8-automation</a> utility manages deploying and updating
applications.  It is able to create deployments to manage the runtime
of the application container, services to provide standard Kubernetes
discovery capabilities, and ingresses to provide the properly hosted
and secured external access to services.</p>
<p>The k8-automation utility runs inside each Kubernetes cluster you want
to deploy applications to, using a Kubernetes <a href="https://kubernetes.io/docs/reference/access-authn-authz/service-accounts-admin/" title="Kubernetes Service Accounts">service account</a>
with only the permissions needed to create, read, update, and delete
namespaces, deployments, services, and ingresses.</p>
<h3 id="container-status">Container status</h3>
<p>The Atomist <a href="https://github.com/atomist/k8vent" title="Atomist k8vent">k8vent</a> utility watches pods in your Kubernetes cluster
and sends change events, e.g., container started and container
crashed, back to Atomist.</p>
<p>Like k8-automation, the k8vent utility runs inside each Kubernetes
cluster you want events from, using a Kubernetes <a href="https://kubernetes.io/docs/reference/access-authn-authz/service-accounts-admin/" title="Kubernetes Service Accounts">service account</a>
with only the permissions needed to watch pod events.</p>
<h3 id="role-based-access-control-rbac">Role-Based Access Control (RBAC)</h3>
<p>To perform their tasks, the Atomist utilities running within a
Kubernetes cluster need access to do so.  In modern, i.e., version 1.6
or greater, Kubernetes clusters, this access is provided using
<a href="https://kubernetes.io/docs/admin/authorization/rbac/" title="Kubernetes - Using RBAC Authorization">role-based access control (RBAC)</a>.  Briefly, a service account
is created and bound to roles with the appropriate privileges.  The
pod is then configured to use the service account when accessing the
Kubernetes API using the in-cluster client.</p>
<p>Part of deploying the Atomist utilities to your Kubernetes cluster is
creating the needed RBAC resources.  To create RBAC resources, your
Kubernetes user needs admin privileges.  If your Kubernetes user does
not have admin privileges in the cluster or a namespace, someone whose
Kuberetes user has those privileges will need to deploy the Atomist
utilities.</p>
<p>If you see errors like the following when you try to deploy the
Atomist utilities to your Kubernetes cluster,</p>
<div class="codehilite"><pre><span></span>Error from server (Forbidden): error when creating &quot;rbac.yaml&quot;: clusterroles.rbac.authorization.k8s.io &quot;k8-automation-clusterrole&quot; is forbidden: attempt to grant extra privileges: [...] user=&amp;{YOUR_USER  [system:authenticated] map[]} ownerrules=[PolicyRule{Resources:[&quot;selfsubjectaccessreviews&quot;], APIGroups:[&quot;authorization.k8s.io&quot;], Verbs:[&quot;create&quot;]} PolicyRule{NonResourceURLs:[&quot;/api&quot; &quot;/api/*&quot; &quot;/apis&quot; &quot;/apis/*&quot; &quot;/healthz&quot; &quot;/swagger-2.0.0.pb-v1&quot; &quot;/swagger.json&quot; &quot;/swaggerapi&quot; &quot;/swaggerapi/*&quot; &quot;/version&quot;], Verbs:[&quot;get&quot;]}] ruleResolutionErrors=[]
</pre></div>


<p>then your Kubernetes user does not have administrative privileges on
your cluster/namespace.  You will either need to ask someone who has
admin privileges on the cluster/namespace to create the RBAC resources
or try to escalate your privileges in the cluster/namespace.  In the
following commands, replace <code>USER</code> with your Kubernetes user name.
To attempt to provide your Kubernetes user with cluster admin
privileges, run:</p>
<div class="codehilite"><pre><span></span>kubectl create clusterrolebinding USER-cluster-admin-binding \
    --clusterrole=cluster-admin --user=USER
</pre></div>


<p>To attempt to provide your Kubernetes user with namespace admin
privileges, run:</p>
<div class="codehilite"><pre><span></span>kubectl create --namespace=NAMESPACE rolebinding USER-admin-binding \
    --clusterrole=admin --user=USER
</pre></div>


<p>Then run the command to deploy the Atomist utilities again.</p>
<div class="admonition hint">
<p class="admonition-title">GKE and RBAC</p>
<p>By default, the user you authenticate with a GKE cluster does not have
sufficient permissions to install the Atomist Kubernetes utilities.
To grant your user the necessary permissions, run the cluster-wide command
above replacing <code>USER</code> in the commands above with
<code>$(gcloud config get-value account)</code>:</p>
<p><code>kubectl create clusterrolebinding \
    $(gcloud config get-value account)-cluster-admin-binding \
    --clusterrole=cluster-admin --user=$(gcloud config get-value account)</code></p>
</div>
<p>If you see errors like the following when you try to deploy the
Atomist utilities to your Kubernetes cluster,</p>
<div class="codehilite"><pre><span></span>unable to decode &quot;https://raw.githubusercontent.com/atomist/k8vent/master/kube/kubectl/cluster-wide.yaml&quot;: no kind &quot;ClusterRole&quot; is registered for version &quot;rbac.authorization.k8s.io/v1beta1&quot;
unable to decode &quot;https://raw.githubusercontent.com/atomist/k8vent/master/kube/kubectl/cluster-wide.yaml&quot;: no kind &quot;ClusterRoleBinding&quot; is registered for version &quot;rbac.authorization.k8s.io/v1beta1&quot;
</pre></div>


<p>then either your <code>kubectl</code> CLI, Kubernetes cluster, or both are too
old and do not support RBAC.  Upgrade your <code>kubectl</code> CLI and
Kubernetes cluster or <a class="contact"
href="mailto:support@atomist.com" title="Contact Atomist">contact
us</a> for help in deploying the Atomist utilities.</p>
<h3 id="cluster-vs-namespace">Cluster vs. namespace</h3>
<p>The Atomist utilities can run in two modes: cluster wide and namespace
scoped.  If your Kubernetes user has cluster-admin role access, which
is typically the case if you created the cluster, you can and probably
should deploy Atomist utilities in cluster-wide mode.  This allows
these utilities to manage and report on applications across all
namespaces in your cluster.  If you are limited to managing Kubernetes
resources in a single namespace and your user has admin role access to
that namespace, you should probably install in namespace-scoped mode.
If your Kubernetes user has neither cluster-admin or admin role
access, you will need to ask someone who does to install the Atomist
utilities in your cluster.</p>
<p>If you want the Atomist Kubernetes utilities to report on and manage
resources in several but not all namespaces, you can deploy the
Atomist utilities using namespace-scoped mode multiple times, one time
for each namespace you want reported on and managed.</p>
<h3 id="cluster-environment">Cluster environment</h3>
<p>The Atomist Kubernetes utilities use the concept of a <em>cluster
environment</em>.  While the cluster environment is an arbitrary
description of the Kubernetes cluster to which you are deploying the
Atomist Kubernetes utilities, it is used to link application
deployment requests and cluster activity to the other activity in your
development flow.  Therefore it should be meaningful to you and your
team and unique across your organization&rsquo;s Kubernetes clusters.
Examples of good cluster environments are &ldquo;production&rdquo;, &ldquo;end-user&rdquo;,
&ldquo;uat&rdquo;, &ldquo;staging&rdquo;, etc.</p>
<p>The cluster environment you provide when installing the Atomist
Kubernetes utilities will be used when reporting on Kubernetes pod
container activity in development lifecycle messages.  For example,
the following image shows the containers that are running a specific
Docker image from a specific commit and build in various namespaces in
the Kubernetes cluster environment &ldquo;gke-int-demo&rdquo;.</p>
<p><img alt="Kubernetes Development Lifecycle Message" src="../img/kubernetes-lifecycle.png" /></p>
<p>The cluster environment is used by k8-automation and your software
delivery machine (SDM) to coordinate application deployments and
upgrades.  Since you may be deploying k8-automation to multiple
Kubernetes clusters, the cluster environment is used as part of the
application deployment/update request to select the Kubernetes
cluster.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>Before you connect Atomist and your Kubernetes cluster(s), you need a
few prerequisites.</p>
<h3 id="atomist-workspace">Atomist workspace</h3>
<p>You must have an Atomist workspace.  If you do not already have one,
you can create one following the instructions in the <a href="../" title="Atomist - Getting Started">getting started
documentation</a>.</p>
<h3 id="kubernetes-cluster">Kubernetes cluster</h3>
<p>You must have a Kubernetes cluster and access to that cluster as a
user with either cluster-admin role privileges to run in cluster-wide
mode or admin role privileges within a namespace to run in
namespace-scoped mode.  If you do not have access to a Kubernetes
cluster, you can create one on your local system using <a href="https://kubernetes.io/docs/getting-started-guides/minikube/" title="Running Kubernetes Locally via Minikube">minikube</a>.</p>
<h2 id="installation">Installation</h2>
<p>Several different methods for installing the Atomist Kubernetes
utilities are supported.  Choose the one that makes sense for your
situation.  If you aren&rsquo;t sure how to proceed, try the <a href="#atomist-cli">Atomist
CLI</a> approach as it is the easiest.</p>
<h3 id="atomist-cli">Atomist CLI</h3>
<p>To use the Atomist CLI to install the Atomist Kubernetes utilities,
you must have the <a href="../../developer/prerequisites/" title="Atomist Developer Prerequisites">Atomist CLI installed and configured</a>.
You will also need the Kubernetes <code>kubectl</code> command-line utility
installed and configured to access your Kubernetes cluster with the
needed privileges.</p>
<p>Once you have the Atomist and Kubernetes CLIs installed and
configured, you can install the Atomist Kubernetes utilities one the
following commands.  Be sure to replace <code>CLUSTER_ENV</code> with a
meaningful name for you Kubernetes cluster/namespace and, if deploying
in namespace-scoped mode, <code>NAMESPACE</code> with the <em>existing</em> namespace
you want to deploy the utilities to.</p>
<h4 id="cluster-wide-mode">Cluster-wide mode</h4>
<p>To install the Atomist Kubernetes utilities in cluster-wide mode, able
to report on and manage resources in all namespaces, run the following
command.</p>
<div class="codehilite"><pre><span></span>atomist kube --environment=&quot;CLUSTER_ENV&quot;
</pre></div>


<h4 id="namespace-scoped-mode">Namespace-scoped mode</h4>
<p>To install the Atomist Kubernetes utilities in namespace-scoped mode,
run the following command for each namespace you want to deploy
them to.  Replace <code>NAMESPACE</code> with the namespace you want to deploy
the utilities to.</p>
<div class="codehilite"><pre><span></span>atomist kube --namespace=&quot;NAMESPACE&quot; --environment=&quot;CLUSTER_ENV&quot;
</pre></div>


<h3 id="kubernetes-cli">Kubernetes CLI</h3>
<p>If you have the <code>kubectl</code> command-line utility installed and
configured to access your Kubernetes cluster with the needed
privileges, you can install the needed Atomist utilities with the
proper configuration using the following commands.  Be sure to replace
<code>CLUSTER_ENV</code> with a meaningful name for you Kubernetes
cluster/namespace, <code>WORKSPACE_ID</code> with your Atomist workspace ID, and
<code>API_KEY</code> with a valid Atomist API key.  See the <a href="../../developer/prerequisites/" title="Atomist Developer Prerequisites">developer
prerequisites</a> for more information on Atomist workspace
IDs and API keys.</p>
<h4 id="cluster-wide-mode_1">Cluster-wide mode</h4>
<h5 id="k8vent">k8vent</h5>
<p>To deploy k8vent in cluster-wide mode and have it report on changes to
all pod containers, run the following command.</p>
<div class="codehilite"><pre><span></span>kubectl apply --filename=https://raw.githubusercontent.com/atomist/k8vent/master/kube/kubectl/cluster-wide.yaml
kubectl create secret --namespace=k8vent generic k8vent --from-literal=environment=&quot;CLUSTER_ENV&quot; \
    --from-literal=webhooks=&quot;https://webhook.atomist.com/atomist/kube/teams/WORKSPACE_ID&quot;
</pre></div>


<h5 id="k8-automation">k8-automation</h5>
<p>To deploy k8-automation in cluster-wide mode with the ability to
manage applications in all namespaces, run the following command.</p>
<div class="codehilite"><pre><span></span>kubectl apply --filename=https://raw.githubusercontent.com/atomist/k8-automation/master/assets/kubectl/cluster-wide.yaml
kubectl create secret --namespace=k8-automation generic automation \
    --from-literal=config=&quot;{\&quot;workspaceIds\&quot;:[\&quot;WORKSPACE_ID\&quot;],\&quot;apiKey\&quot;:\&quot;API_KEY\&quot;,\&quot;environment\&quot;:\&quot;CLUSTER_ENV\&quot;}&quot;
</pre></div>


<h4 id="namespace-scoped-mode_1">Namespace-scoped mode</h4>
<p>In the commands below, replace <code>NAMESPACE</code> with the namespace you want
to deploy the utilities to.</p>
<h5 id="k8vent_1">k8vent</h5>
<p>To deploy k8vent in namespace-scoped mode such that it will only
report on pod containers in a single namespace, run the following
commands.</p>
<div class="codehilite"><pre><span></span>kubectl create secret --namespace=&quot;NAMESPACE&quot; generic k8vent \
    --from-literal=environment=&quot;CLUSTER_ENV&quot; \
    --from-literal=webhooks=&quot;https://webhook.atomist.com/atomist/kube/teams/WORKSPACE_ID&quot;
kubectl apply --namespace=&quot;NAMESPACE&quot; \
    --filename=https://raw.githubusercontent.com/atomist/k8vent/master/kube/kubectl/namespace-scoped.yaml
</pre></div>


<h5 id="k8-automation_1">k8-automation</h5>
<p>To deploy k8-automation in namespace-scoped mode such that it will
only deploy and update resources in a single Kubernetes cluster
namespace, run the following commands.</p>
<div class="codehilite"><pre><span></span>kubectl create secret --namespace=&quot;NAMESPACE&quot; generic automation \
    --from-literal=config=&quot;{\&quot;workspaceIds\&quot;:[\&quot;WORKSPACE_ID\&quot;],\&quot;apiKey\&quot;:\&quot;API_KEY\&quot;,\&quot;environment\&quot;:\&quot;CLUSTER_ENV\&quot;,\&quot;kubernetes\&quot;:{\&quot;mode\&quot;:\&quot;namespace\&quot;}}&quot;
kubectl apply --namespace=&quot;NAMESPACE&quot; \
    --filename=https://raw.githubusercontent.com/atomist/k8-automation/master/assets/kubectl/namespace-scoped.yaml
</pre></div>


<h3 id="helm">Helm</h3>
<p>If you manage resources in your Kubernetes cluster with <a href="https://helm.sh/" title="Helm Package Manager for Kubernetes">Helm</a>,
you can install the Atomist Kubernetes utilities using Helm.  Replace
<code>API_KEY</code> with an Atomist API key, <code>WORKSPACE_ID</code> with your Atomist
workspace ID, and <code>CLUSTER_ENV</code> with a meaningful name for your
Kubernetes cluster/namespace.</p>
<div class="admonition bug">
<p class="admonition-title">Helm and Minikube</p>
<p>Due to a bug in the default minikube bootstrapper localkube,
<a href="https://github.com/kubernetes/helm/issues/3135#issuecomment-344291890">kubernetes/helm#3135: Helm 2.7.0 creates RBAC resource
fail</a>, if you want to manage RBAC resources using Helm
in minikube, you must start minikube using the kubeadm bootstrapper.</p>
<p><code>minikube start --bootstrapper kubeadm</code></p>
<p>You can make kubeadm your default bootstrapper by running the
following command.</p>
<p><code>minikube config set bootstrapper kubeadm</code></p>
</div>
<h4 id="cluster-wide-mode_2">Cluster-wide mode</h4>
<p>To install all of the Atomist Kubernetes utilities in cluster-wide
mode, run the following <code>helm</code> command.</p>
<div class="codehilite"><pre><span></span>helm upgrade --install --namespace=atomist atomist-utilities \
    --repo=https://atomist.github.io/helm-charts atomist-utilities \
    --set=global.atomist.apiKey=&quot;API_KEY&quot; \
    --set=global.atomist.workspaceIds=&quot;{WORKSPACE_ID}&quot; \
    --set=global.atomist.environment=&quot;CLUSTER_ENV&quot;
</pre></div>


<h4 id="namespace-scoped-mode_2">Namespace-scoped mode</h4>
<p>To install all of the Atomist Kubernetes utilities in namespace-scoped
mode, run the following <code>helm</code> command for each namespace you want to
deploy them to.  Replace <code>NAMESPACE</code> with the namespace you want to
deploy the utilities to.</p>
<div class="codehilite"><pre><span></span>helm upgrade --install --namespace=&quot;NAMESPACE&quot; &quot;atomist-utilities-NAMESPACE&quot; \
    --repo=https://atomist.github.io/helm-charts atomist-utilities \
    --set=global.atomist.apiKey=&quot;API_KEY&quot; \
    --set=global.atomist.workspaceIds=&quot;{WORKSPACE_ID}&quot; \
    --set=global.atomist.environment=&quot;CLUSTER_ENV&quot; \
    --set=global.atomist.mode=namespace
</pre></div>


<h2 id="updating">Updating</h2>
<p>You can update to a new version of the Atomist Kubernetes utilities
using standard Kubernetes approaches.  If you installed the Atomist
utilities using the Atomist CLI or Helm, simply re-run the same
command you ran to install them.  If you are using <code>kubectl</code> you can
run the following commands, replacing <code>NAMESPACE</code> and <code>M.N.P</code> as
appropriate.</p>
<div class="codehilite"><pre><span></span>kubectl set image --namespace=NAMESPACE \
    deployment/k8vent k8vent=atomist/k8vent:M.N.P
kubectl set image --namespace=NAMESPACE \
    deployment/k8-automation k8-automation=atomist/k8-automation:M.N.P
</pre></div>


<p>You can always find the latest versions of
<a href="https://github.com/atomist/k8-automation/releases/latest" title="k8-automation Latest Release">k8-automation</a> and <a href="https://github.com/atomist/k8vent/releases/latest" title="k8vent Latest Release">k8vent</a> on
their release pages.</p>
<!--

### Kubernetes

This automation works with [Kubernetes][kube], so you need a
Kubernetes cluster with a functioning ingress controller, such as
[ingress-nginx][].

If you do not have access to a Kubernetes cluster, you can create one
on your local system using [minikube][].  Once you have minikube
running, you can create an ingress controller in the cluster using the
ingress add-on.


wzxhzdk:13


[kube]: https://kubernetes.io/ (Kubernetes)
[ingress-nginx]: https://github.com/kubernetes/ingress-nginx (Ingress nginx)
[minikube]: https://kubernetes.io/docs/getting-started-guides/minikube/ (Minikube)

## Configuration

You can run k8-sdm in either "cluster-wide" mode or
"namespace-scoped" mode.  In cluster-wide mode, k8-sdm is able
to deploy and update applications in any namespace but it requires a
user with cluster-admin role privileges to install it.  If you only
have access to admin role privileges in a namespace, you can install
k8-sdm in namespace-scoped mode, where it will only be able to
deploy and update resources in that namespace.

## Running

See the [Atomist Kubernetes documentation][atomist-kube] for detailed
instructions on using Atomist with Kubernetes.  Briefly, if you
already have an [Atomist workspace][atomist-getting-started], you can
run the following commands to create the necessary resources in your
Kubernetes cluster.  Replace `WORKSPACE_ID` with your Atomist
workspace/team ID and `TOKEN` with a GitHub token with "read:org"
scopes for a user within the GitHub organization linked to your
Atomist workspace.


wzxhzdk:14


[atomist-kube]: https://docs.atomist.com/user/kubernetes/ (Atomist - Kubernetes)
[atomist-getting-started]: https://docs.atomist.com/user/ (Atomist - Getting Started)

## SDM interface

The KubeDeploy event handler triggers off an SDM Goal with the
following properties:

JSON Path | Value
----------|------
`fulfillment.name` | @atomist/k8-sdm
`fulfillment.method` | side-effect
`state` | requested

In addition, it expects the SDM Goal to have a `data` property that
when parsed as JSON has a `kubernetes` property whose value is an
object with the following properties:

Property | Required | Description
---------|----------|------------
`name` | Yes | Name of the resources that will be created
`environment` | Yes | Must equal the value of the running k8-sdm instance's `configuration.environment`
`ns` | No | Namespace to create the resources in, default is "default"
`imagePullSecret` | No | Name of the Kubernetes image pull secret, if omitted the deployment spec is not provided an image pull secret
`port` | No | Port the container service listens on, if omitted the deployment spec will have no configured liveness or readiness probe and no service will be created
`path` | No | Absolute path under the hostname the ingress controller should use for this service, if omitted no ingress rule is created
`host` | No | Host name to use in ingress rule, only has effect if `path` is provided, if omitted when `path` is provided, the rule is created under the wildcard host
`protocol` | No | Scheme to use when setting the URL for the service endpoint, "https" or "http", default is "https" if `tlsSecret` is provided, "http" otherwise
`replicas` | No | Number of replicas (pods) deployment should have
`tlsSecret` | No | Name of existing [Kubernetes TLS secret][kube-tls] to use when configuring the ingress
`deploymentSpec` | No | Stringified JSON Kubernetes deployment spec to overlay on top of default deployment spec, it only needs to contain the properties you want to add or override from the default
`serviceSpec` | No | Stringified JSON Kubernetes service spec to overlay on top of default service spec, it only needs to contain the properties you want to add or override from the default

Full details for the `kubernetes` property can be found in the TypeDoc
for [`KubeApplication`][kube-app].

[kube-tls]: https://kubernetes.io/docs/concepts/services-networking/ingress/#tls (Kubernetes Ingress TLS)
[kube-app]: https://atomist.github.io/k8-sdm/interfaces/_lib_k8_.kubeapplication.html (Atomist - KubeApplication - TypeDoc)

-->
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../docker/" title="Docker" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Docker
              </span>
            </div>
          </a>
        
        
          <a href="../issue/" title="Issue" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Issue
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; 2018 Atomist, Inc.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
<div class="md-footer-social">
  <link rel="stylesheet" href="../../assets/fonts/fix-mime-type-font-awesome.css">
  
  <a href="https://the-composition.com/" class="md-footer-social__link fa fa-medium"></a>
  
  <a href="https://github.com/atomist" class="md-footer-social__link fa fa-github"></a>
  
  <a href="https://twitter.com/atomist" class="md-footer-social__link fa fa-twitter"></a>
  
  <a href="https://join.atomist.com/" class="md-footer-social__link fa fa-slack"></a>
  
</div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.583bbe55.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../js/intercom.js"></script>
      
        <script src="../../js/mixpanel.js"></script>
      
    
    
      
    
  </body>
</html>